---
title: "Analysis"
author: "April"
date: "September 7, 2017"
output: github_document
---

This is a practice document for gitmd for the IFD repo.
TODO
Link this with the Setup data environment to create plots/figures to put in this rm file.
Change to gitmd output


```{r, setting, echo = FALSE, include=FALSE} 
#make this block silent
library(plyr)
library(ggplot2)
library(gridExtra)
library(pwr)
library(dplyr)

setwd("C:/Users/alpeterson7/Documents/HannahVR/HVRrepo")
data<- load("HVR_data_setup.RData")

```

### Summary of Interfocal Distances from a F2 Cross

discription of the data and purpose of Analysis. BD data of MLH1 measures in meiotice cells. HVR measures of inter-focal distances of foci on the same bivalent. 

#### Initial Stats
- number of mice used

- mean and variance of MLH1 for each category (boxplots)

- mean and variance of IFD for each category

mouse specific tables to be used in plots. I should be able to add BD's data.
```{r, tables, echo=FALSE}
#mice used in each category (HVR and BD)
BD_mice_num <- ddply(BD_data, .(Cross), summarize,
                        N_mice = length(unique(ANIMAL_ID)), 
                     num_cells = length(nMLH1_foci)
)
  
HVR_mice_num <- ddply(data_HVR_full, .(Cross), summarize,
                        N_mice = length(unique(Animal.ID)), 
                     num_IFD = length(IFD)
)
HVR_mice_num
BD_mice_num
```
Not all of the PWD from HVR data overlap with the PWD in BD data set.



* histogram of IFD
(the echo= false ) still produces some output code.
```{r, histIFD, echo=FALSE, include = FALSE}
#make sure outliers are removes
hh <- hist(IFD_nMLH1$IFD)#adjust the axis names

gg <- hist(IFD_nMLH1$nMLH1_foci)
hh
gg
```
The histogram appears normally distributed, but with a slight right tail.

#### Things to look at
* proportion of CO classes (per mouse)
* range of proportion classes
* mean and variation of IFD
* min value per F2 mouse
* normalized IFD **
* relationsihp of total SC and CO number


These F2's were genrated to compared the average CO number per cell across two HM subspecies. Comparing the the average propotions of bivalent types (1CO, 2CO ect) per cell breaks down that phenotype one more level.
Approach; BD data, She filled out the proportions.

Since measuring the proportion of object classes from HVR's data would require the assumption that there are no 0COs, (which is not true), Useing BD's data will be more acurate. 
But the general approach of quantifying CO proportions from HVR data would be something like... 19 - ( length(IFD) - n3CO*2).
```{r, class_proportions}
BDmouseBivClass_proportions <- ddply(BD_data, .(ANIMAL_ID), summarize,
                   #  Cross = as.factor(Cross),
                    nChr = mean(nChr),
                   nCells = length(nMLH1_foci),
                     biv0CO =  mean( (as.numeric(nChrWithoutXO) ) ) / nCells,
                     biv1CO =  mean( (as.numeric(nChrWith1XO) ) ) / nCells , 
                     biv2CO =  mean( (as.numeric(nChrWith2XO) ) ) / nCells ,
                     biv3CO =  mean( (as.numeric(nChrWith3.XO) ) )/ nCells 
)
#increase the denominator to nCells * 19
# should the proportions be compared to the MLH1 number?

# match these mice to the mice in IFD_MLH1, 

```

#### range and distribution of IFD measures.
```{r, IFD plots}

#IFD_bxplt <- boxplot((IFD_nMLH1$ANIMAL_ID), IFD_nMLH1$IFD, main= "IFD distributions")
#use ggplot

#IFD_bxplt
```