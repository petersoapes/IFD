CO3 = sum(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(file_name), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#SE
nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(file_name)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages <- ddply(data_PWD, .(file_name), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#SE
nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(file_name)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
View(data_PWD)
View(mergd_file_name)
data_PWD <- mergd_file_name[mergd_file_name$Cross.x == "PWD", ] #the file names for many PWD don't match
View(data_PWD)
PWD_image_averages <- ddply(data_PWD, .(file_name), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#SE
nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(file_name)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
View(mergd_file_name)
mergd_file_name <- merge.data.frame(BD_MLH1_data, data_HVR_full, by.y = "File.ID", by.x = "file_name", all=FALSE)
View(mergd_file_name)
for(h in 1:length(data_HVR_full$File.ID)){
#if col 6 of 7 match and 7th(IFD doesn't ) 3CO
if( (data_HVR_full$File.ID[h] == data_HVR_full$File.ID[h+1]  ) &&
(data_HVR_full$Biv.ID[h]==data_HVR_full$Biv.ID[h+1] ) ){
print(c("double ", h) )
data_HVR_full$n3CO[h] = 1
}
}
View(data_HVR_full)
mergd_file_name <- merge.data.frame(BD_MLH1_data, data_HVR_full, by.y = "File.ID", by.x = "file_name", all=FALSE)
View(mergd_file_name)
View(data_HVR_full)
data_PWD <- data_HVR_full[data_HVR_full$Cross == "PWD", ]
PWD_image_averages <- ddply(data_PWD, .(file_name), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#SE
nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(file_name)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#SE
nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(file_name)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#SE
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(file_name)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#SE
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#SE
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
#lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#SE
#nMLH1_foci = mean(nMLH1_foci),
#ncells = length(unique(File.ID)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
#lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#SE
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
#lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
View(data_HVR_full)
View(data_PWD)
str(data_PWD)
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
nIFD_measures = length(IFD),
# xbar_IFD = mean(IFD),
# varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE),
#lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
nIFD_measures = length(IFD),
# xbar_IFD = mean(IFD),
# varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE)
#lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
# num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
total_bivs = (ncells*20),
nCO3 = sum(n3CO, na.rm=TRUE)
#lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
# num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
nIFD_measures = length(IFD),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
total_bivs = (ncells*20),
n3CO = sum(n3CO, na.rm=TRUE),
n2CO = total_bivs - n3CO
#lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
# num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFD_measures = length(IFD),
n2CO = nIFD_measures - n3CO
#lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
# num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFD_measures = length(IFD),
n2CO = nIFD_measures - n3CO,
n1CO = 20- (n3CO+n2CO)
#lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
# num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFDs = length(IFD),
n2CO = nIFDs - n3CO,
n1CO = 19 - (n3CO+n2CO)
#lnCO3 = length(n3CO, na.rm=TRUE),
#CO3 = max(n3CO),  #parents won't have 3CO
# num_2CO = abs(length(IFD)-(n3CO*2))  #this is too large
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
Animal.ID,
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFDs = length(IFD),
n2CO = nIFDs - n3CO,
n1CO = 19 - (n3CO+n2CO)
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
Animal.ID = Animal.ID,
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFDs = length(IFD),
n2CO = nIFDs - n3CO,
n1CO = 19 - (n3CO+n2CO)
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
mouse = Animal.ID,
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFDs = length(IFD),
n2CO = nIFDs - n3CO,
n1CO = 19 - (n3CO+n2CO)
)
PWD_image_averages
PWD_image_averages <- ddply(data_PWD, .(File.ID), summarize,
mouse = unique(Animal.ID),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFDs = length(IFD),
n2CO = nIFDs - n3CO,
n1CO = 19 - (n3CO+n2CO)
)
PWD_image_averages
PWD_mouse_av <- ddply(PWD_image_averages, .(mouse), summarize,
ncells = sum(ncells),
p1CO = ( ncells*19 ) / n1CO
)
PWD_mouse_av
PWD_mouse <- ddply(PWD_image_averages, .(mouse), summarize,
ncells = sum(ncells),
p1CO =  n1CO /( ncells*19 )
#                   p2CO =
)
PWD_mouse
PWD_mouse <- ddply(PWD_image_averages, .(mouse), summarize,
ncells = sum(ncells),
mean (xbar_IFD),
p1CO =  n1CO /( ncells*19 )
#                   p2CO =
)
PWD_mouse
PWD_mouse <- ddply(PWD_image_averages, .(mouse), summarize,
# ncells = sum(ncells),
tot_1CO = sum(n1CO),
mean (xbar_IFD),
p1CO =  tot_1CO /( ncells*19 )
#                   p2CO =
)
PWD_mouse
PWD_image_averages
PWD_mouse <- ddply(PWD_image_averages, .(mouse), summarize,
ncells = length(ncells),
mean (xbar_IFD),
tot_1CO = sum(n1CO),
p1CO =  tot_1CO /( ncells*19 )
#                   p2CO =
)
PWD_mouse
PWD_mouse <- ddply(PWD_image_averages, .(mouse), summarize,
ncells = length(ncells),
avIFD = mean(xbar_IFD),
tot_1CO = sum(n1CO),
tot_2CO= sum(n2CO),
tot_3CO= sum(n3CO),
p1CO =  tot_1CO /( ncells*19 ),
p2CO= tot_2CO/( ncells*19 ),
p3CO=tot_3CO/( ncells*19 )
)
PWD_mouse
View(BD_MLH1_data)
PWD_mouse <- ddply(PWD_image_averages, .(mouse), summarize,
avIFD = mean(xbar_IFD),
ncells = length(ncells),
totbiv = ncells*19,
tot_1CO = sum(n1CO),
tot_2CO= sum(n2CO),
tot_3CO= sum(n3CO),
p1CO =  tot_1CO /( ncells*19 ),
p2CO= tot_2CO/( ncells*19 ),
p3CO=tot_3CO/( ncells*19 )
)
PWD_mouse
PWD_image_averages
data_F2 <- data_HVR_full[data_HVR_full$Cross == "F2", ]
F2_image_averages <- ddply(data_F2, .(File.ID), summarize,
mouse = unique(Animal.ID),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFDs = length(IFD),
n2CO = nIFDs - n3CO,
n1CO = 19 - (n3CO+n2CO)
)
F2_image_averages
F2_mouse <- ddply(F2_image_averages, .(mouse), summarize,
avIFD = mean(xbar_IFD),
ncells = length(ncells),
totbiv = ncells*19,
tot_1CO = sum(n1CO),
tot_2CO= sum(n2CO),
tot_3CO= sum(n3CO),
p1CO =  tot_1CO /( ncells*19 ),
p2CO= tot_2CO/( ncells*19 ),
p3CO=tot_3CO/( ncells*19 )
)
F2_mouse
View(PWD_mouse)
plot(F2_mouse$avIFD, F2_mouse$p3CO)
plot(c(PWD_mouse$avIFD ,F2_mouse$avIFD), c(PWD_mouse$p3CO, F2_mouse$p3CO) )
data_F2 <- data_HVR_full[data_HVR_full$Cross == "F2", ]
F2_image_averages <- ddply(data_F2, .(File.ID), summarize,
mouse = unique(Animal.ID),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFDs = length(IFD),
n2CO = nIFDs - n3CO,
n1CO = 19 - (n3CO+n2CO)
)
F2_mouse <- ddply(F2_image_averages, .(mouse), summarize,
avIFD = mean(xbar_IFD),
ncells = length(ncells),
totbiv = ncells*19,
tot_1CO = sum(n1CO),
tot_2CO= sum(n2CO),
tot_3CO= sum(n3CO),
p1CO =  tot_1CO /( ncells*19 ),
p2CO= tot_2CO/( ncells*19 ),
p3CO=tot_3CO/( ncells*19 )
)
F2_mouse
F2_image_averages
load(file="HVR_data_setup.RData")
View(data_HVR_full)
unique(Animal.ID)
unique(data_HVR_full$Animal.ID)
for(h in 1:length(data_HVR_full$File.ID)){
#if col 6 of 7 match and 7th(IFD doesn't ) 3CO
if( (data_HVR_full$File.ID[h] == data_HVR_full$File.ID[h+1]  ) &&
(data_HVR_full$Biv.ID[h]==data_HVR_full$Biv.ID[h+1] ) ){
print(c("double ", h) )
data_HVR_full$n3CO[h] = 1
}
}
data_PWD <- data_HVR_full[data_HVR_full$Cross == "PWD", ]
data_F2 <- data_HVR_full[data_HVR_full$Cross == "F2", ]
F2_image_averages <- ddply(data_F2, .(File.ID), summarize,
mouse = unique(Animal.ID),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFDs = length(IFD),
n2CO = nIFDs - n3CO,
n1CO = 19 - (n3CO+n2CO)
)
F2_mouse <- ddply(F2_image_averages, .(mouse), summarize,
avIFD = mean(xbar_IFD),
ncells = length(ncells),
totbiv = ncells*19,
tot_1CO = sum(n1CO),
tot_2CO= sum(n2CO),
tot_3CO= sum(n3CO),
p1CO =  tot_1CO /( ncells*19 ),
p2CO= tot_2CO/( ncells*19 ),
p3CO=tot_3CO/( ncells*19 )
)
F2_mouse
View(data_HVR_full)
unique(data_HVR_full$Animal.ID)
unique(data_HVR_full$Cross)
data_F2 <- data_HVR_full[(data_HVR_full$Cross == "F2" || data_HVR_full$Cross == "CXPF2"), ]
F2_image_averages <- ddply(data_F2, .(File.ID), summarize,
mouse = unique(Animal.ID),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFDs = length(IFD),
n2CO = nIFDs - n3CO,
n1CO = 19 - (n3CO+n2CO)
)
F2_image_averages
View(data_F2)
data_F2 <- data_HVR_full[data_HVR_full$Cross == "F2", ]
data_xF2 <- data_HVR_full[data_HVR_full$Cross == "CXPF2", ]
data_F2 <- data_HVR_full[data_HVR_full$Cross == "F2", ]
data_xF2 <- data_HVR_full[data_HVR_full$Cross == "CXPF2", ]
F2 <- rbind(data_F2, data_xF2)
F2_image_averages <- ddply(F2, .(File.ID), summarize,
mouse = unique(Animal.ID),
xbar_IFD = mean(IFD),
varIFD = var(IFD),
#nMLH1_foci = mean(nMLH1_foci),
ncells = length(unique(File.ID)),
n3CO = sum(n3CO, na.rm=TRUE),
nIFDs = length(IFD),
n2CO = nIFDs - n3CO,
n1CO = 19 - (n3CO+n2CO)
)
F2_mouse <- ddply(F2_image_averages, .(mouse), summarize,
avIFD = mean(xbar_IFD),
ncells = length(ncells),
totbiv = ncells*19,
tot_1CO = sum(n1CO),
tot_2CO= sum(n2CO),
tot_3CO= sum(n3CO),
p1CO =  tot_1CO /( ncells*19 ),
p2CO= tot_2CO/( ncells*19 ),
p3CO=tot_3CO/( ncells*19 )
)
F2_mouse
head(F2_image_averages)
plot(F2_mouse$avIFD, F2_mouse$p3CO)
rm(F2_mouse[35,]
)
rm(F2_mouse[35])
rm(F2_mouse[,35])
ff <- subset(F2_mouse, mouse != "3030")
ff
plot(F2_mouse$avIFD, F2_mouse$p3CO)
plot(F2_mouse$avIFD, F2_mouse$p3CO)
plot(ff$avIFD, ff$p3CO)
